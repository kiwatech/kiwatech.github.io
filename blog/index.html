<html>

<head>
    <style>
        div.container {
            width 70vw;
        }
        iframe {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div class="container" id="posts-container">

    </div>

    <script>
        const renderPost = (post) => {
            return `<div class="post">
                <h3 class="post-title">${/title: (.+)/g.exec(post)[1]}</h3>
                <span class="post-date">${/date: (.+)/g.exec(post)[1]}</span>
                <div class="post-contents">` + 
                post.split('---\n')[1].replace(/!\[(.+)]\((.+)\)/g, (a, b, c) => {
                    return `<img alt="${b}" src="${c}">`
                });
        }

        let posts = [];

        const fetchPosts = () => {
            fetch(`./posts/${posts.length.toString().padStart(4, 0)}.html`)
            .then(res => {
                if (res.status != 200) throw res.status;
                posts.push(`<iframe class="post" href="./posts/${posts.length.toString().padStart(4, 0)}"></iframe>`);
                fetchPosts();
            }).catch(err => {
                document.getElementById('posts-container').innerHTML = posts.join('\n');
            });
        }
        fetchPosts();
    </script>
</body>

</html>